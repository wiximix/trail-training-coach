
## 版本 083249e
docs: 成功上传 projects 文件夹到 GitHub 仓库

## 版本 b78208b
docs: 创建 GitHub 上传脚本 upload_to_github.sh

## 版本 58bc891
feat: 优化成绩预测页面动态更新和布局顺序

## 版本 8f3cd4d
feat: 优化表格分段用时提示，显示详细公式和具体配速数值

## 版本 5f01887
feat: 优化成绩预测页面布局，新增总补给份数显示

## 版本 6b65eda
feat: 将成绩预测页面的预测参数改为可伸缩侧边栏 
  1. 新增sidebarExpanded状态：控制侧边栏展开/收起
  2. 重构页面布局：分为左侧固定侧边栏和右侧主内容区域
  3. 实现侧边栏功能： - 展开时宽度320px（w-80） - 收起时宽度0 - 包含所有预测参数表单 - 添加关闭按钮
  4. 实现主内容区域： - 根据侧边栏状态动态调整左边距 - 添加展开/收起按钮 - 包含预测结果展示 - 添加空状态提示
  5. 优化过渡动画：使用transition-all和duration-300实现平滑动画

## 版本 749849e
feat: 实现应用计划配速按钮功能
  1. 新增handleApplyGlobalPace函数：将全局计划配速应用到所有CP点
  2. 修改应用计划配速按钮：从调用后端API改为前端本地更新
  3. 优化按钮禁用状态：仅在没有结果或全局计划配速为空时禁用
  4. 实时重新计算：应用配速后立即更新分段用时和预计时间


## 版本 3ae6f5d
fix: 修复CP点计划配速输入框显示和输入问题 
  1. 将计划配速输入框类型从number改为text，避免数字显示问题
  2. 添加数字验证，只允许输入数字字符
  3. 确保input的value正确绑定到checkpointPaces状态
  4. 保持onChange和onBlur事件处理逻辑不变

## 版本 c376a4e
fix: 修正爬升等效距离计算并改进计划配速输入格式 
  1. 修正爬升等效距离：从 爬升/10 改为 爬升*10
  2. 改进计划配速输入：改为MMSS格式（如630代表6分30秒）
  3. 实现实时计算：修改CP计划配速后，分段用时和预计时间自动更新（失焦或回车触发）
  4. 添加MMSS转换函数：mmssToMinutes和minutesToMMSS用于格式转换
  5. 更新tooltip说明：更新分段用时的计算公式说明

## 版本 e0b4eeb
feat: 计算分段用时时使用计划配速 
修改内容： 
  - 修改后端API逻辑，使用计划配速计算分段用时和预计时间
  - 支持全局计划配速和每个CP点独立计划配速
  - 优先级：CP独立配速 > 全局计划配速 > 算法预测配速
  - 前端添加"应用计划配速"按钮，支持基于自定义配速重新计算
  - 前端发送checkpointPaces到后端，支持每个CP独立设置计划配速版本 067a3a6

## 版本 067a3a6
feat: 添加计划配速功能 
新增功能：
  - 在成绩预测页面添加计划配速输入字段
  - API接口支持接收和返回计划配速
  - CP点预计时间表格中显示计划配速
  - 每个路段的计划配速支持独立编辑
  - 技术实现：
  - 前端添加计划配速状态管理
  - API接口扩展PredictionRequest和PredictionResult类型
  - 表格添加计划配速列和输入框
  - 支持全局计划配速和每个路段独立配速

## 版本 cb96ff1
refactor: 将能量需求从碳水改为热量(Kcal/小时) 
修改内容：
- 更新核心算法：计算公式从体重×1g改为体重×4Kcal
- 更新接口注释：carbs字段从碳水(g/小时)改为热量
- 更新前端显示：预测页面和复盘页面中的"碳水"改为"热量"
- 更新API注释：类型定义中的注释同步更新


## 版本 3c1cef6
refactor: 抽离越野跑成绩预测核心算法为独立模块 
重构内容： 
  - 新增 src/lib/trailAlgorithm.ts 核心算法模块（550行）
  - 新增 src/lib/__tests__/verify.ts 算法验证脚本 - 新增 REFACTORING_GUIDE.md 重构文档
  - 重构 src/app/trails/[id]/edit/page.tsx 使用抽离的算法
  - 重构 src/app/api/predict/route.ts 使用抽离的算法
算法抽离范围：
  - 坡度计算：calculatePer100mElevation、calculateSlopePercent
  - 爬升影响值：calculateElevationFactor（分级计算）
  - 配速计算：parsePace、calculateTrailPace
  - 时间格式化：formatTime、formatPace
  - 补给策略：calculateHourlyEnergyNeeds、calculateSupplyDosages、generateSupplyStrategy
改进点：
  - 算法函数均为纯函数，无副作用
  - 完整的TypeScript类型定义
  - 详细的中文注释和使用示例
  - 边界值处理（距离为0、配速为空等）
  - 业务代码减少135行，可维护性显著提升


## 版本 d7bae57
fix: 修复浏览器扩展导致的 React Hydration 错误


## 版本 836033d
perf: 优化数据库连接性能，实现单例模式减少连接开销

## 版本 3d40ffc
perf: 优化数据库连接性能，实现单例模式减少连接开销

## 版本 386cbfc
feat: 编辑赛道页面CP点列表增加爬升影响字段及自动计算


## 版本 787f288
feat: 预测结果CP点列表增加爬升影响列及详细计算提示

## 版本 770f174
fix: 修复赛段数据坡度计算与显示异常问题

## 版本 3d304ef
feat: 赛道编辑页面改为列表形式并添加坡度自动计算功能

## 版本 88edcf4
feat: 预测结果页面分段用时字段添加公式提示

## 版本 bb76c71
fix: 允许赛道段落距离输入两位小数

## 版本 1d70096
fix: 修复数据更新后列表页面显示不同步的问题 


## promt 5 版本 a288c36
feat: 增强预测结果页面 - CP点补给详情、路段信息显示、小数点精度

## 版本 9aab523
feat: 实现成员列表视图增强和复盘功能 
1. 成员管理页面增强 - 添加列选择功能，用户可自定义显示的属性字段
   - 实现单选编辑功能，选中成员后可快速编辑
   - 添加乳酸阈值配速信息显示 - 根据静息心率和最大心率，自动计算并显示5个储备心率区间(HRR)
2. 成绩预测功能增强 - 添加电解质粉热量和冲水量输入 - 计算并显示总能量需求（总碳水、总水量、总电解质）
   - CP点预计时间表格新增列：下坡距离、路段类型、路段配速系数、分段用时 - 预计平均配速显示单位明确为 分钟/KM
   - 补给策略整合电解质粉的热量和水量数据
3. 复盘功能完整实现 - 创建复盘记录表(reviews)，存储预测历史和实际数据
   - 复盘API支持创建、读取、更新、删除复盘记录
   - 复盘页面支持记录每个CP点的实际数据：
     * 实际用时 * 平均心率和最大心率
     * 补给情况（水量、热量、电解质） - 根据用户储备心率，心率输入显示不同颜色区间提示
   - 显示预测vs实际对比，便于分析训练效果
4. 数据库schema扩展
   - members表添加lactate_threshold_pace字段
   - 创建reviews表，支持完整的复盘数据存储

## 版本 9cec5a7
feat: 实现路段类型管理和增强补给策略功能 1. 赛道CP点增强 - 添加路段类型属性（沙地、机耕道、山路、石铺路、台阶） - 添加下坡距离字段 - 修改赛道新增/编辑页面UI，支持新字段输入 2. 跑者路段配速系数 - 在成员表中添加terrainPaceFactors字段 - 成员新增/编辑页面添加路段配速系数编辑功能 - 默认值：沙地1.1，其他类型1.0 3. 补给策略增强 - 成绩预测页面添加补给含量输入（能量胶、盐丸、电解质粉） - 输出每小时能量需求（碳水Kcal、水ml、电解质mg） - 计算并显示每小时补给份数 4. 成绩计算逻辑优化 - 集成路段配速系数到配速计算 - 根据不同路段类型调整用时预测 - 增强补给策略生成逻辑


## 版本 a81e3ec
style: 调整所有输入框字体颜色为更深的gray-900 修改了以下页面的所有input和select元素，添加text-gray-900类使字体颜色更明显： - 成员新增/编辑页面（20个输入框） - 赛道新增/编辑页面（8个输入框） - 成绩预测页面（3个下拉框）



## 版本 d2035ae
feat: 完成越野训练教练APP开发 实现了完整的越野训练教练系统，包括： - 成员数据管理（基础数据、跑力数据、补给数据） - 赛道数据管理（赛道信息、CP点详细数据） - 成绩和补给策略智能预测算法 - 完整的CRUD操作和响应式UI界面 - 基于Next.js + PostgreSQL + Drizzle ORM的技术栈