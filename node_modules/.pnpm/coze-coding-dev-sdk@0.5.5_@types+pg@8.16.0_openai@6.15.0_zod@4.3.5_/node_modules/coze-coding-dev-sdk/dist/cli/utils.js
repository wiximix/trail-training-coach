"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.parseHeaders = parseHeaders;
exports.sanitizeHeaders = sanitizeHeaders;
function parseHeaders(headerStrings) {
    if (!headerStrings || headerStrings.length === 0) {
        return undefined;
    }
    const headers = {};
    for (const headerStr of headerStrings) {
        let key;
        let value;
        if (headerStr.includes(': ')) {
            const parts = headerStr.split(': ');
            key = parts[0];
            value = parts.slice(1).join(': ');
        }
        else if (headerStr.includes('=')) {
            const parts = headerStr.split('=');
            key = parts[0];
            value = parts.slice(1).join('=');
        }
        else {
            throw new Error(`Invalid header format: '${headerStr}'. Use 'Key: Value' or 'Key=Value'`);
        }
        headers[key.trim()] = value.trim();
    }
    return Object.keys(headers).length > 0 ? headers : undefined;
}
function sanitizeHeaders(headers) {
    const sensitiveKeys = [
        'authorization',
        'auth',
        'api-key',
        'apikey',
        'api_key',
        'x-api-key',
        'x-auth-token',
        'token',
        'secret',
        'password',
        'passwd',
        'pwd',
    ];
    const sanitized = {};
    for (const [key, value] of Object.entries(headers)) {
        const lowerKey = key.toLowerCase();
        const isSensitive = sensitiveKeys.some(sensitiveKey => lowerKey.includes(sensitiveKey));
        if (isSensitive) {
            sanitized[key] = '***';
        }
        else {
            sanitized[key] = value;
        }
    }
    return sanitized;
}
//# sourceMappingURL=utils.js.map