"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ImageGenerationClient = void 0;
const client_1 = require("../core/client");
const exceptions_1 = require("../core/exceptions");
const models_1 = require("./models");
class ImageGenerationClient extends client_1.BaseClient {
    constructor(config, customHeaders, verbose = false) {
        super(config, customHeaders, verbose);
        this.model = models_1.ImageConfig.DEFAULT_MODEL;
    }
    async generate(request) {
        const apiRequest = (0, models_1.buildImageGenerationApiRequest)(request, this.model);
        const data = await this.request('POST', `${this.config.baseUrl}/api/v3/images/generations`, apiRequest);
        if (data.error) {
            throw new exceptions_1.APIError(`API returned error: ${data.error.message || 'Unknown error'}`, data.error.code ? parseInt(data.error.code) : 500, data.error);
        }
        for (const item of data.data) {
            if (item.error) {
                throw new exceptions_1.APIError(`Image generation failed: ${item.error.message || 'Unknown error'}`, item.error.code ? parseInt(item.error.code) : 500, item.error);
            }
        }
        return data;
    }
    async batchGenerate(requests) {
        const promises = requests.map((request) => this.generate(request));
        return Promise.all(promises);
    }
    getResponseHelper(response) {
        return new models_1.ImageGenerationResponseHelper(response);
    }
}
exports.ImageGenerationClient = ImageGenerationClient;
//# sourceMappingURL=client.js.map